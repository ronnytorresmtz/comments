!function(t){var e={};function n(s){if(e[s])return e[s].exports;var o=e[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:s})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){n(1),t.exports=n(6)},function(t,e,n){Nova.booting(function(t,e,s){t.component("comments",n(2))})},function(t,e,n){var s=n(3)(n(4),n(5),!1,null,null,null);t.exports=s.exports},function(t,e){t.exports=function(t,e,n,s,o,a){var i,r=t=t||{},m=typeof t.default;"object"!==m&&"function"!==m||(i=t,r=t.default);var l,c="function"==typeof r?r.options:r;if(e&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0),n&&(c.functional=!0),o&&(c._scopeId=o),a?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),s&&s.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},c._ssrRegister=l):s&&(l=s),l){var u=c.functional,d=u?c.render:c.beforeCreate;u?(c._injectStyles=l,c.render=function(t,e){return l.call(e),d(t,e)}):c.beforeCreate=d?[].concat(d,l):[l]}return{esModule:i,exports:r,options:c}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:["resourceName","resourceId","panel"],mounted:function(){this.initProperties(),this.getComments()},data:function(){return{comment:"",userId:"",userName:"",comments:{},baseUrl:"/nova-vendor/comments/comments",url:"",pagination:[],per_page:"",showOnlyMyComments:"",loading:!0}},methods:{initProperties:function(){this.url=this.baseUrl,this.per_page=void 0===this.panel.fields[0].per_page?this.per_page=5:this.per_page=this.panel.fields[0].per_page,this.userId=Nova.config.user.id,this.userName=Nova.config.user.name,this.userCompanyId=Nova.config.user.company_id||null,this.showOnlyMyComments=void 0!==this.panel.fields[0].showOnlyMyComments&&this.panel.fields[0].showOnlyMyComments},applyShowOnlyMyComments:function(){this.showOnlyMyComments=!this.showOnlyMyComments,this.fetchPaginateComments(this.baseUrl)},fetchPaginateComments:function(t){this.url=t,this.getComments()},getComments:function(){var t=this;this.loading=!0,axios.get(this.url,{params:{resourceName:this.resourceName,resourceId:this.resourceId,company_id:this.userCompanyId,per_page:this.per_page,showOnlyMyComments:this.showOnlyMyComments}}).then(function(e){t.comments=e.data,t.pagination=e.data,t.loading=!1}).catch(function(e){t.$toasted.show(e,{type:"error"}),t.loading=!1})},saveComment:function(){var t=this;if(this.isEmpty(this.comment))this.$toasted.show("Write your comment before saving",{type:"error"});else{this.loading=!0;var e=this.getComment();axios.post(this.baseUrl,e).then(function(e){t.resetComment(),t.fetchPaginateComments(t.baseUrl),t.$toasted.show("Comment was added!",{type:"success"})}).catch(function(e){t.$toasted.show(e,{type:"error"})})}},getComment:function(){return{resourceId:this.resourceId,resourceName:this.resourceName,company_id:this.userCompanyId,user_id:this.userId,username:this.userName,text:this.comment}},deleteComment:function(t){var e=this;this.loading=!0,axios.delete(this.baseUrl+"/"+t).then(function(t){e.fetchPaginateComments(e.baseUrl),e.$toasted.show("Comment was deleted!",{type:"success"})}).catch(function(t){e.$toasted.show(t,{type:"error"})})},isEmpty:function(t){return void 0===t||null==t||t.length<=0},resetComment:function(){this.comment=""},formatDate:function(t){return moment(t).format("llll")},getClassForPreviusNext:function(t){return"btn btn-link btn-border-none py-3 px-4 dim "+(t?"text-primary":"text-gray")},showPagination:function(){return void 0!==this.pagination.total&&0!==this.pagination.total}}}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"flex justify-between pb-4 border-b border-40"},[n("h1",{staticClass:"flex-no-shrink text-90 font-normal text-2xl"},[t._v("\n      Comments \n      "),n("span",{directives:[{name:"show",rawName:"v-show",value:void 0!==t.pagination.total,expression:"pagination.total !== undefined"}]},[t._v(" \n        ("+t._s(t.pagination.total)+") \n      ")])]),t._v(" "),n("button",{staticClass:"btn btn-default btn-primary inline-flex items-center relative",attrs:{type:"submit"},on:{click:function(e){return e.preventDefault(),t.saveComment(e)}}},[t._v("\n        Save Comment\n    ")])]),t._v(" "),n("div",{staticClass:"card"},[n("div",{staticClass:"card mb-6 py-3 px-6"},[n("div",{staticClass:"flex justify-between"},[n("h4",{staticClass:"font-normal text-80"},[t._v("\n            Write new comment\n          ")]),t._v(" "),n("div",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.showOnlyMyComments,expression:"showOnlyMyComments"}],attrs:{type:"checkbox",id:"showOnlyMyComments"},domProps:{checked:Array.isArray(t.showOnlyMyComments)?t._i(t.showOnlyMyComments,null)>-1:t.showOnlyMyComments},on:{click:function(e){return t.applyShowOnlyMyComments()},change:function(e){var n=t.showOnlyMyComments,s=e.target,o=!!s.checked;if(Array.isArray(n)){var a=t._i(n,null);s.checked?a<0&&(t.showOnlyMyComments=n.concat([null])):a>-1&&(t.showOnlyMyComments=n.slice(0,a).concat(n.slice(a+1)))}else t.showOnlyMyComments=o}}}),t._v(" "),n("label",{staticClass:"font-normal text-80",attrs:{for:"showOnlyMyComments"}},[t._v("Show Only My Comments")]),n("br")])]),t._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.comment,expression:"comment"}],staticClass:"w-full form-control form-input form-input-bordered py-3 h-auto mt-2 mb-2",attrs:{id:"commenter",dusk:"commenter",rows:"5"},domProps:{value:t.comment},on:{keyup:function(e){return(e.type.indexOf("key")||13===e.keyCode)&&e.ctrlKey?t.saveComment(e):null},input:function(e){e.target.composing||(t.comment=e.target.value)}}}),t._v(" "),n("div",{staticClass:"help-text"},[t._v("\n            On MacOS, press âŒ˜ + Enter, on Windows press Ctrl + Enter to save\n        ")]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"mt-2"},[n("loader",{staticClass:"pb-6 text-60"})],1),t._v(" "),t._l(t.comments.data,function(e){return n("div",{key:e.id},[n("div",{staticClass:"commenter__comment py-4 border-t border-40"},[n("div",{staticClass:"font-light text-80 text-sm"},[n("a",{staticClass:"no-underline dim text-primary font-bold",attrs:{href:"/nova/resources/users/"+t.userId}},[t._v("\n                  "+t._s(e.username)+"  \n                ")]),t._v(" "),n("span",{staticClass:"mr-1"},[t._v(" said on "+t._s(t.formatDate(e.created_at))+" ")]),t._v(" "),n("span",{staticClass:"mr-2 cursor-pointer",on:{click:function(n){return t.deleteComment(e.id)}}},[n("svg",{staticClass:"fill-current text-80",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 20 20","aria-labelledby":"delete",role:"presentation"}},[n("path",{attrs:{"fill-rule":"nonzero",d:"M6 4V2a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2h5a1 1 0 0 1 0 2h-1v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6H1a1 1 0 1 1 0-2h5zM4 6v12h12V6H4zm8-2V2H8v2h4zM8 8a1 1 0 0 1 1 1v6a1 1 0 0 1-2 0V9a1 1 0 0 1 1-1zm4 0a1 1 0 0 1 1 1v6a1 1 0 0 1-2 0V9a1 1 0 0 1 1-1z"}})])])]),t._v(" "),n("div",{staticClass:"mt-2"},[t._v("\n              "+t._s(e.text)+"\n            ")])])])})],2),t._v(" "),n("nav",{directives:[{name:"show",rawName:"v-show",value:t.showPagination(),expression:"showPagination()"}],staticClass:"flex justify-between items-center bg-20 rounded-b"},[n("button",{class:t.getClassForPreviusNext(t.pagination.prev_page_url),attrs:{disabled:!t.pagination.prev_page_url},on:{click:function(e){return t.fetchPaginateComments(t.pagination.prev_page_url)}}},[t._v("\n            Previous\n        ")]),t._v(" "),n("span",{staticClass:"text-sm text-80 px-4"},[t._v(" "+t._s(t.pagination.from)+"-"+t._s(t.pagination.to)+" of "+t._s(t.pagination.total))]),t._v(" "),n("button",{class:t.getClassForPreviusNext(t.pagination.next_page_url),attrs:{disabled:!t.pagination.next_page_url},on:{click:function(e){return t.fetchPaginateComments(t.pagination.next_page_url)}}},[t._v("\n            Next\n        ")])])])])},staticRenderFns:[]}},function(t,e){}]);